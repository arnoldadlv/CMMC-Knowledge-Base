# 3.13.8 - Expertise Overlay

**Control Text:** Implement cryptographic mechanisms to prevent unauthorized disclosure of CUI during transmission unless otherwise protected by alternative physical safeguards.

**Assessment Objectives:**
- 3.13.8[a] cryptographic mechanisms intended to prevent unauthorized disclosure of CUI are identified.
- 3.13.8[b] alternative physical safeguards intended to prevent unauthorized disclosure of CUI are identified.
- 3.13.8[c] either cryptographic mechanisms or alternative physical safeguards are implemented to prevent unauthorized disclosure of CUI during transmission.

---

## Sufficient

### MPLS (Common-Carrier Provided)
- **DoD Assessment Methodology explicitly states:** "When implementing this requirement, encryption, though preferred, is not required if using common-carrier provided Multiprotocol Label Switching (MPLS), as the MPLS separation provides sufficient protection without encryption."
- Must be **standard common-carrier MPLS** - software-defined networks (SD-WAN) do NOT qualify as "true MPLS"

### TLS 1.2 with FIPS Mode
- Windows Server 2019 with FIPS mode enabled via GPO + TLS 1.2 enforced is sufficient for transmission protection
- TLS uses the underlying encryption module of the operating system - if Windows is in FIPS mode, it uses the FIPS-validated Windows encryption modules
- "TLS is the standard. It is the encryption module that is FIPS validated" (Spock67, Certified Assessor)

### GCC High Email
- GCC High has disabled TLS 1.0 and 1.1, only TLS 1.2 is supported
- GCC High uses FIPS-validated cryptography
- "If you're forcing TLS, and GCCH only uses TLS 1.2, and GCCH uses FIPS validated crypto: the other party shouldn't matter" (rybo)
- Can configure Exchange connectors to enforce TLS on a per-domain basis for partner organizations

### External Provider Responsibility
- If downloading from DoD SAFE, Microsoft GCC High, or a prime contractor - encryption responsibility is on them
- You are responsible for your end of the transmission

---

## Insufficient

### Unencrypted MPLS (Non-Standard)
- One organization reported DIBCAC deducted points for unencrypted MPLS ("pretty much just because it wasn't encrypted")
- **Assessor inconsistency noted:** Some assessors accept MPLS, others do not
- Software-defined networks are NOT true MPLS and may not qualify for the MPLS exception

### Opportunistic TLS / Legacy Email
- Legacy commercial Exchange uses "opportunistic TLS" which will downgrade to older protocols or no encryption if TLS 1.2 fails
- "Both ends have to be properly configured to enforce TLS. And it is very hard to tell that this is being done." (Spock67)
- Standard Outlook TLS/AES encryption alone is NOT sufficient - you cannot verify the remote end is properly configured

### WiFi Without FIPS-Validated Encryption
- WAP not in FIPS mode transmitting CUI = FAIL
- "Assessors tend not to accept physical security controls for wireless connections. Unless it's in a SCIF or something that's uber protected and the signal can't get out." (Glenda R. Snodgrass, Lead CCA)
- Even if device authentication (3.5.2) is enforced, non-FIPS WiFi encryption is insufficient

### Security Through Obscurity
- "But security through obscurity is not generally allowed in compliance" (Amira Armond, C3PAO)
- Being a small company in an obscure location does not justify weaker encryption

---

## Over-engineering

### S/MIME for All GCC High Users
- One user was asked by their client to purchase Identrust S/MIME certificates for all users
- This is likely **over-engineering** if GCC High with forced TLS connectors is already in place
- S/MIME provides end-to-end encryption but may not be required if transport layer is already FIPS-encrypted
- However, S/MIME does provide additional benefits: makes users conscious of CUI handling, provides signature/non-repudiation

### Double-Encrypting Before Sending to CUI-Approved Systems
- "We have been trying to ensure everything is FIPS validated encrypted before we send it off; even to our data transfer solution which is approved for CUI. Sounds like that is not necessary." (RWeReady)
- If the transfer solution is already CUI-approved with proper encryption, pre-encrypting may be unnecessary

---

## Edge Cases

### Testing Email TLS Configuration
- "Very simple, attempt to connect to (non SSL) SMTP port on o365 gcch.. if open then that means incoming emails can be unencrypted in transit" (Amira Armond, C3PAO)
- Can use telnet to test SMTP communication to verify TLS enforcement

### Fax/POTS
- DoD guidance states: "Data transmission of CUI transmitted over standard telephone dial-up service (POTS) similarly should be separately encrypted as no protection is expected to be provided by the telephone system."
- However: "Voice communication of CUI over the telephone is not addressed by NIST SP 800-171 or by DFARS clause 252.204-7012"
- Note: "They also miss that their write up actually makes fax a no no, as it is an unencrypted transmission over POTS. FAX is ok though." (Spock67) - indicating assessor inconsistency on fax

### VPN + SMB Encryption Layering
- Question raised: If SMBv3 encryption is enabled on file server and endpoints are in FIPS mode, does VPN also need FIPS?
- Answer: If you can prove every byte containing CUI is FIPS encrypted on the VLAN, you "may be able to get a C3PAO to buy into it" - but this has been theoretical discussion, unclear if anyone has passed assessment with this approach
- "It is normally assumed that every machine that touches a VLAN can see all the bytes on that VLAN" (MonkSecurity)

### Incoming Email TLS Enforcement
- Open question: Are organizations expected to ensure ALL incoming emails are TLS encrypted?
- Using connectors with verified partners enforces TLS in both directions
- For unknown senders, this is more challenging

### CNC Machines / Legacy Equipment
- Legacy CNC machines requiring SMBv1 create challenges - cannot enforce SMB encryption
- If on WiFi without FIPS-validated encryption, this is likely a FAIL

### NIST 800-171 Rev 3 Impact
- "When we move to 171r3, there is no more 'alternate physical safeguard.' Even on-site CUI data flows will need encrypted, sticking the ethernet in a conduit won't cut it anymore."
- This will fundamentally change VLAN scoping discussions

---

## Evidence Examples

### Acceptable Evidence (Discussed)
- Windows Server FIPS mode enabled via GPO
- TLS 1.2 enforcement configuration
- FIPS certificates downloaded from NIST website for Windows Server 2019
- Exchange connector configurations showing forced TLS
- Common-carrier MPLS contract documentation

### Testing Methods (Mentioned)
- Telnet to SMTP port to verify TLS-only connectivity
- Wireshark to verify encryption in transit (mentioned but noted as difficult)
- Exchange message trace to verify TLS version used

---

## Key Quotes

**On MPLS:**
> "Regarding this discussion the Gospel says: ... When implementing this requirement, encryption, though preferred, is not required if using common-carrier provided Multiprotocol Label Switching (MPLS), as the MPLS separation provides sufficient protection without encryption." - Mark Soule (citing DoD Assessment Methodology)

> "The problem is when you have nonstandard MPLS" - Jake (Fellow)

> "Software defined networks are not a true MPLS." - Jake (Fellow)

**On Risk Assessment:**
> "In general, I'd only be concerned about unencrypted MPLS if sensitive information (CUI) was passing over it in unencrypted form. So I'm assuming that we have unencrypted CUI going across a site to site link. Which is a no no according to CMMC, if 'the confidentiality of CUI is not protected in transit'.. So the question is, do we have a risk to the confidentiality?" - Amira Armond (C3PAO)

> "I wouldn't be very sympathetic to the idea that encryption slows the traffic too much. That is what having a big bulky expensive firewall / router and symmetric encryption is for." - Amira Armond (C3PAO)

**On Email Encryption:**
> "Both ends have to be properly configured to enforce TLS. And it is very hard to tell that this is being done. The presumption is that somebody is not." - Spock67 (Certified CMMC Assessor)

> "If you're forcing TLS, and GCCH only uses TLS 1.2, and GCCH uses FIPS validated crypto: the other party shouldn't matter." - rybo (Moderator)

> "Very simple, attempt to connect to (non SSL) SMTP port on o365 gcch.. if open then that means incoming emails can be unencrypted in transit" - Amira Armond (C3PAO)

**On TLS and FIPS:**
> "TLS uses the underlying encryption module of the operating system. So if your W10 is in Fips Mode and properly configured then it uses the underlying FIPS validated windows encryption module." - Spock67 (Certified CMMC Assessor)

> "TLS is the standard. It is the encryption module that is FIPS validated" - Spock67 (Certified CMMC Assessor)

**On WiFi:**
> "Assessors tend not to accept physical security controls for wireless connections. Unless it's in a SCIF or something that's uber protected and the signal can't get out." - Glenda R. Snodgrass (Lead CCA)

**On VPN/VLAN Encryption:**
> "It is normally assumed that every machine that touches a VLAN can see all the bytes on that VLAN, even if that endpoint was not the machine that sent/received the packets. If it is possible to prove that every byte that contains CUI is FIPS encrypted on that VLAN, you may be able to get a C3PAO to buy into it." - MonkSecurity (CCP)

**On Rev 3 Changes:**
> "When we move to 171r3, there is no more 'alternate physical safeguard.' Even on-site CUI data flows will need encrypted, sticking the ethernet in a conduit won't cut it anymore." - Cuipacabra (CCP)

---

## Notable Contributors
- **Amira Armond** (C3PAO, CMMCAudit.org) - Risk-based assessment perspective
- **Spock67** (Certified CMMC Assessor, CCP, Consultant) - Technical implementation details on TLS/FIPS
- **rybo** (Moderator, Fellow, MEP) - GCC High and Exchange configuration expertise
- **Jake** (Fellow) - MPLS technical distinctions
- **Glenda R. Snodgrass** (Lead CCA) - WiFi physical security assessor perspective
- **MonkSecurity** (CCP) - VLAN scoping and encryption layering
