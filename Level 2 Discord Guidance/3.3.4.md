# 3.3.4 - Expertise Overlay
## Alert in the event of an audit logging process failure

**Assessment Objectives (800-171A):**
- [a] personnel or roles to be alerted in the event of an audit logging process failure are identified
- [b] types of audit logging process failures for which alert will be generated are defined
- [c] identified personnel or roles are alerted in the event of an audit logging process failure

---

## Sufficient

### Technical Implementations Confirmed Acceptable:
1. **GPO "Shut down system immediately if unable to log security audits"**
   - Approved approach for Windows environments
   - Combined with firewall alert when server becomes unreachable
   - Expert note: "On the surface, it sounds good" - Glenda R. Snodgrass (Lead CCA)

2. **SIEM alert when log source stops sending events**
   - Passed SSP example: "The SIEM is configured to generate an alert when a monitored log source has not sent any events within a specified timeframe. The cybersecurity team investigates the alert and works with the system administrator to determine why the log flows stopped." - Jake (passed DIBCAC)

3. **Heartbeat query in Sentinel with Logic App**
   - Triggering alert when endpoint fails to report for 3 consecutive days (accounting for weekend shutdowns)
   - "More than sufficient" - Amira Armond (C3PAO)

4. **Firewall syslog server unreachability alerts**
   - Alert when syslog server is unreachable from firewall
   - Alert on syslog server when firewall is unreachable
   - Bidirectional monitoring accepted

5. **Azure Monitor/Service Health alerts with Action Groups**
   - Valid approach for Azure Sentinel environments

6. **Threshold-based log count monitoring**
   - Scheduled task counting records received, alerting if below threshold
   - Even threshold of <1 (zero logs) counts as discovering audit log process failure
   - "Failure is logs stop" - Amira Armond

### FedRAMP/Cloud Inheritance:
- M365 GCC-High: Control is inherited for SaaS components
- SSP language: "Microsoft performs this control within the m365 environment, see their FedRAMP SSP, AU-#"
- IaaS/PaaS (Azure VMs/apps): NOT inherited - must implement own alerting
- Must map 800-53 AU-5 from FedRAMP SRM to 800-171 control

---

## Insufficient

### Common Failures:
1. **Just having an alert created without documentation**
   - Must have all three parts: [a] identified personnel/role, [b] defined failure types, [c] working alerts
   - "Just having an alert created will not address the security control you need to have three parts" - Alabaster

2. **Manually checking if logs came in**
   - "You can't go manually check if logs came in. An alert, email, notification, text, ticket, etc, must be generated and sent to a responsible person or team." - Amira Armond

3. **Not verifying cloud provider responsibilities**
   - "Don't make assumptions. You are responsible for furnishing proof that all controls are being met, whether by you or by someone on your behalf (Microsoft). You need to get their SRM, identify what they are doing on your behalf, and supplement as necessary." - Glenda R. Snodgrass (Lead CCA)

4. **Missing log monitoring from breach story**
   - "An organization discovers that they were breached because government secrets are being sold on the dark web. DC3 incident response teams are called; they start digging into the logs to find out what happened. But they are immediately stymied - there are no logs from the firewall or servers. No one knows whether the bad guys turned off the logs, or if they broke on their own." - Amira Armond (explaining why this is a Top 10 Failed Requirement)

---

## Over-engineering

### Cautions Raised:
1. **Automatic shutdown may not always be appropriate**
   - "Shutting down the system is not always the best option. I would recommend speaking to an incident response expert to see if that is a good option or maybe go with other isolation techniques." - Alabaster
   - Considerations: Initial responders need to see system state; law enforcement may want to monitor before eradication
   - Endorsed by Amira Armond and Glenda R. Snodgrass

2. **Alerting on individual endpoint logging for part-time devices (laptops)**
   - "In my experience, assessors don't expect this for endpoints that could be on or off normally." - Amira Armond
   - For part-time devices, need creative approaches vs. 24x7 systems (firewalls, servers)

3. **Consider DoS attack vector**
   - "From a security point of view, I would recommend considering a denial of service for filling up the logs." - Alabaster

---

## Edge Cases

### Mobile Devices (BYOD Android/iOS):
- **Not N/A** - technically possible via mobile management or endpoint management tools
- However, passed DIBCAC without device-level audit logging for mobile devices using MAM (Intune)
- "We don't send logs direct from the devices, so it wasn't an issue" - Jake
- "In 3.3.1 we do not say that we log that type of data from mobile devices" - Jake
- Only controls 3.1.18 and 3.1.19 specifically call out mobile device requirements
- MAM reporting sufficient: "As long as the MAM is reporting, you are good"

### Laptops/Part-time Endpoints:
- Assessors understand some systems are 24x7 (firewalls, servers) and some are 8x5 (laptops)
- "For the systems that are 24x7, you should absolutely have individual alerts for each system set up"
- For part-time devices, need to establish "normal" log generation thresholds
- Example: 3-day heartbeat for weekend-shutdown endpoints is "more than sufficient"

### SaaS Clouds (M365, etc.):
- Need to verify cloud provider performs this requirement internally
- FedRAMP Moderate baseline includes this control - can inherit if cloud is FedRAMP authorized
- Must discuss in SSP how you verified cloud is performing 3.3.4
- Reference Customer Responsibility Matrix (CRM) and map 800-53 controls

### Third-Party SIEM Without M365 Alert Capability (Log360 example):
- If SIEM cannot alert on M365 log ingestion failures, workaround proposed:
- Daily report for M365 logins/activity - error code indicates log ingestion failure
- No explicit confirmation this workaround is acceptable

---

## Evidence Examples

### Accepted Evidence Types:
1. Screenshot of SIEM alert configuration for log source failure
2. Screenshot showing alert being delivered to identified personnel
3. GPO showing "Audit: Shut down system immediately if unable to log security audits"
4. Firewall unreachability alert configuration
5. Azure Sentinel custom analytics rule with heartbeat query
6. Logic App configuration for alert delivery
7. FedRAMP SRM showing cloud provider inheritance
8. Documentation identifying personnel/roles responsible for alerts
9. Policy/procedure defining types of failures that trigger alerts

### SSP Language Examples:
- "The SIEM is configured to generate an alert when a monitored log source has not sent any events within a specified timeframe. The cybersecurity team investigates the alert and works with the system administrator to determine why the log flows stopped."
- "Microsoft performs this control within the m365 environment, see their FedRAMP SSP, AU-#."

---

## Key Quotes

> "For 3.3.4, we expect an organization to set up push alerts which go to the correct people when audit logs drop below an expected level." - Amira Armond (C3PAO)

> "Push alerts: You can't go manually check if logs came in. An alert, email, notification, text, ticket, etc, must be generated and sent to a responsible person or team." - Amira Armond

> "Go to the correct people: When being assessed, a great piece of evidence is showing an alert for audit log failure coming in to the person who is identified as responsible for fixing audit log issues." - Amira Armond

> "For 3.3.4 there are 3 items of importance (ref NIST 800-171a) [a] person or role is identified to be alerted when audit logging stops; [b] types of failures that alert of failure are also documented; [c] is that [a] and [b] work defined. Just having an alert created will not address the security control you need to have three parts." - Alabaster

> "In my experience, assessors don't expect this for endpoints that could be on or off normally." - Amira Armond (regarding laptops)

> "Failure is logs stop. Not logs are slightly different than normal." - Amira Armond

> "More than sufficient. Again, most assessors not too concerned about endpoints that are expected to be turned off regularly." - Amira Armond (regarding 3-day heartbeat for endpoints)

> "This would be inherited for M365, but if you have IaaS or PaaS services in Azure it likely is not inherited for those VMs/apps" - Cuipacabra (CCP)

> "Don't make assumptions. You are responsible for furnishing proof that all controls are being met, whether by you or by someone on your behalf (Microsoft)." - Glenda R. Snodgrass (Lead CCA)

> "This is how new requirements are born. (sigh)" - Amira Armond (on why 3.3.4 is in the Top 10 Failed Requirements)

---

## Notable Contributors
- **Amira Armond** - C3PAO, CMMCAudit.org (primary expert)
- **Glenda R. Snodgrass** - Lead CCA
- **Jake** - Passed DIBCAC assessment
- **Alabaster** - Verified member
- **Cuipacabra** - CCP (Certified CMMC Professional)

---

*Source: Cooey COE Discord - audit-and-accountability channel - 3.3.4 thread*
*Export date: 2026-01-07*
*Message count: 68*
