# 3.5.10 - Expertise Overlay
## Store and transmit only cryptographically-protected passwords

**Assessment Objectives:**
- 3.5.10[a] passwords are cryptographically protected in storage
- 3.5.10[b] passwords are cryptographically protected in transit

---

## Sufficient

### Windows/AD Environment
- Windows domain with reversible encryption DISABLED in GPO is sufficient
- DoD Windows STIG allows credential caching AND requires disabling reversible encryption
- Kerberos for Windows desktops to DC provides encrypted transmission
- LDAPS (port 636) for any LDAP integrations

### Password Managers
- Password managers ARE acceptable - no prohibition in control objectives
- Well-known tools (Bitwarden, Keeper, etc.) that cryptographically store passwords meet the requirement
- Full disk encryption on devices where password files reside counts as "encrypted when stored" (even Notepad files)
- On-prem options like Bitwarden self-hosted are acceptable
- LAPS using AD/Entra to store local admin passwords passes assessments

### Transmission
- TLS encryption for any in-scope systems using credentials/passwords
- HTTPS/443 for web-based password managers
- IPsec tunnel for HTTP sites qualifies IF the crypto is adequate (question raised about FIPS validation)

### Evidence Approaches
- Microsoft documentation can serve as evidence for Windows/AD/O365
- CIS/CRM for O365 if in scope
- Supporting documentation about how a tool functions (e.g., vendor whitepapers showing encryption)

---

## Insufficient

### Unacceptable Practices
- Passwords stored in unencrypted Excel or Notepad files (unless on FDE-protected device)
- Passwords stored in browsers (shadow IT)
- Passwords on physical sticky notes or paper (unless cryptographically encoded - debated)
- LDAP on port 389 (unencrypted) - must use LDAPS or other encrypted protocol
- Unknown/questionable password managers (e.g., "storeyurpasswd.cn" example used to illustrate the point)

### Transmission Issues
- HTTP without encrypted tunnel
- Unencrypted LDAP integrations with domain

---

## Over-engineering

### FIPS/FedRAMP NOT Required
- **Key clarification from rybo (Moderator):** "FIPS validation is described nowhere in this requirement. Passwords for nonfederal systems aren't CUI, and you aren't required to use FIPS validated crypto to store or transmit them."
- FIPS only required when encryption provides confidentiality for CUI - passwords are SPD (Security Protection Data), not CUI
- FedRAMP authorization NOT required for password managers
- Using FedRAMP tools when not required adds unnecessary cost to DIB contractors

### Assessor Warning
- From Glenda R. Snodgrass (Lead CCA): "I just heard today that there is someone teaching CCP/CCA classes that SPD requires FIPS and FRME. There are assessors out there that believe this." - This is INCORRECT
- Some assessors may "take umbrage" if you don't use FR version when available, but it is NOT required

### Credential Caching
- Disabling credential caching entirely and forcing VPN authentication for laptop login is over-engineering
- "That MSP must love angering frequent travelers" - rybo's comment on forcing VPN login
- DISA's enhanced security control for cached authenticators to expire after one hour only applies to Linux servers in STIGs, not Windows

---

## Edge Cases

### Password Managers as SPA
- Password managers ARE considered Security Protection Assets (SPA) because they store SPD (passwords that grant access to in-scope environment)
- Passwords are "100% SPD as defined in 32 CFR" - from scotty, CCP
- SPAs must "Assess against Level 2 security requirements that are relevant to the capabilities provided"
- **Key distinction from Liatris (LCCA):** User-chosen password managers (browser built-in, shadow IT) are NOT in scope. Company-authorized/deployed password managers ARE SPAs and in scope.

### Further Discussion vs Control Objectives
- The "Further Discussion" section in CMMC AG suggests one-way hashing and prohibits reversible encryption
- However, **this is NOT enforceable** - only the Assessment Objectives matter
- From Glenda R. Snodgrass (Lead CCA): "IIRC the Further Discussion sections were written for the CMMC AGs by DoD and/or Mitre not by NIST. I teach in my workshops that they are useful for ideas but are not authoritative."
- Password managers use reversible encryption by design (to retrieve passwords) and this is ACCEPTABLE

### SSO Consideration
- One approach: Use SSO for everything with CUI access, then passwords for non-CUI systems are out of scope
- Challenge: What about break glass accounts, service accounts, local accounts? These still need to be addressed

### Non-FedRAMP Cloud Tools
- Can still use non-FR tools but need CRM (Customer Responsibility Matrix) or equivalent documentation
- FedRAMP provides easier inheritance model but is not mandatory
- From Liatris (LCCA): "The OSC can't 'inherit' specifically if it isn't FedRAMP... but it can be a CRM"

---

## Evidence Examples

### Acceptable Evidence
- GPO settings showing reversible encryption disabled
- Microsoft documentation on password hashing in Windows/AD
- Vendor documentation showing password manager uses encryption at rest
- TLS/HTTPS configuration for transmission
- CIS benchmarks/CRM for O365
- Network configuration showing LDAPS (636) vs LDAP (389)
- LAPS configuration documentation

### For Password Managers
- Vendor whitepapers on encryption methods
- FedRAMP authorization (if available - makes assessment easier but not required)
- Configuration showing encryption settings
- Supporting documentation about how the tool functions

---

## Key Quotes

**On FIPS Requirement (Correction of Common Misunderstanding):**
> "FIPS validation is described nowhere in this requirement. Passwords for nonfederal systems aren't CUI, and you aren't required to use FIPS validated crypto to store or transmit them." - rybo (Moderator)

**On Further Discussion Authority:**
> "IIRC the Further Discussion sections were written for the CMMC AGs by DoD and/or Mitre not by NIST. I teach in my workshops that they are useful for ideas but are not authoritative." - Glenda R. Snodgrass, Lead CCA

**On Password Managers:**
> "Password managers are SPA so need to meet the controls. But no reason you can't use one." - Glenda R. Snodgrass, Lead CCA

**On Credential Caching:**
> "That MSP must love angering frequent travelers. There's no need to do it that way. The DoD Windows STIG allows credential caching, and also requires you to disable reversible encryption." - rybo (Moderator)

**On FedRAMP for Password Managers:**
> "And no reason it has to be FedRAMP Authorized either." - scotty, CCP

**On SPD Definition (from 32 CFR Final Rule):**
> "Security Protection Data (SPD) means data stored or processed by Security Protection Assets (SPA) that are used to protect an OSC's assessed environment. SPD is security relevant information and includes but is not limited to: configuration data required to operate an SPA, log files generated by or ingested by an SPA, data related to the configuration or vulnerability status of in-scope assets, and passwords that grant access to the in-scope environment."

**On Password Manager Scoping:**
> "The line I tend to draw is if your users use a password manager (like built in to the Browser or some shadow IT they signed up for) then those individual instances are not in scope (since you are expecting the user to protect the password). But if your company authorizes a password manager and sets up an account for each employee, then the password manager would be an SPA" - Liatris, LCCA

**On Full Disk Encryption:**
> "if you have full disk encryption, then they are encrypted when 'stored'... even in notepad" - ace_rimmer (Fellow)

---

## Common Technical Considerations

### Windows Domain
- Disable reversible encryption in GPO (default should be disabled)
- Use Kerberos (default for Windows-to-DC)
- Use LDAPS (636) not LDAP (389) for any third-party integrations

### Password Transmission
- TLS for all web-based authentication
- HTTPS/443 for cloud password managers
- Kerberos for domain authentication

### Password Storage
- AD stores passwords in NTDS.DIT - encrypted by default
- Password managers encrypt vault
- Full disk encryption covers local storage scenarios
