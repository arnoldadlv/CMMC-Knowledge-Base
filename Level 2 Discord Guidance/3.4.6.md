# 3.4.6 - Expertise Overlay

**Control Text:** Employ the principle of least functionality by configuring organizational systems to provide only essential capabilities.

**Assessment Objectives:**
- 3.4.6[a] essential system capabilities are defined based on the principle of least functionality.
- 3.4.6[b] the system is configured to provide only the defined essential capabilities.

---

## Sufficient

- **Define essential capabilities and reference enforcement tools:** List the tools that enforce least functionality (Puppet, MS Active Directory, GPO, AAD, AppLocker) in the SSP, and state that you do it. No need to keep SSP updated with granular settings.
  - *"List the tools that do it and say that you do it. No reason to keep your SSP up to date with your Puppet/AD/GPO/AAD/etc settings"* - Jake (Fellow)

- **Reference baselines:** Tie least functionality to baselines configured per controls 3.4.1 and 3.4.2. IT staff reviews system capabilities, compares to what is needed, and disables unnecessary functionality.

- **HW/SW/FW list with justification column:** A hardware/software/firmware list with a column explaining why each software entry is needed, correlated with AppLocker group policy settings as verifiable evidence.
  - *"I like seeing justification for installed SW somewhere."* - Kenneth Ingham (CCA)

- **Pre-installed software can be justified if it serves a purpose:** Tools like Dell recovery utilities, Dell Command Update, and .NET runtime that come pre-installed are acceptable IF they have a documented business purpose (e.g., recovery).
  - *"If the tools have a purpose to you, like recovery, then your justification is easy. You do need to do it though."* - Uncouth (CCP, Fellow)

- **IT provisioning ensures baseline compliance:** Having IT provision systems and ensure they meet baselines before delivery to users demonstrates least functionality.

---

## Insufficient

- **Assuming pre-installed software is automatically acceptable:** Pre-installed software does not automatically meet the control. Even if software came with the laptop, you must identify, control, and manage it.
  - *"If my laptop came preinstalled with Kaspersky does that make it ok? No."* - Uncouth (CCP, Fellow)
  - *"Still yours to identify control and manage"* - Uncouth (CCP, Fellow)

- **Failing to document justification for installed software:** If installed software differs from the 3.4.1 baseline, you need 3.4.3 and 3.4.4 change management documentation for that change.

---

## Over-engineering

- **Keeping SSP updated with every Puppet/AD/GPO setting:** No reason to maintain granular tool configuration details in the SSP. Reference the tools and state that you do it.

- **Listing every single capability in the SSP:** Not necessary. Define the approach, reference tools, and ensure baselines are documented separately.

---

## Edge Cases

- **Pre-installed OEM software (Dell recovery tools, .NET runtime, etc.):** These require the same treatment as any other software. If different from baseline, document via 3.4.3/3.4.4. If keeping them, document justification for why they are needed in baseline documentation.

- **Small companies combining resources:** Combining DNS and Domain controls on a single system is acceptable for small companies. Document the defined capabilities and restrict/disable what is not being used. These settings become configuration items for your 3.4.1 baseline.
  - Example: *"You may have combined resources such as DNS and Domain controls for a small company. That is entirely acceptable. It just needs to be documented (defined), and what the components or subcomponents are not doing should be restricted, disabled, or prevented."* - Alabaster

---

## Evidence Examples

- **Sample SSP language (accepted):**
  > "As part of the baselines configured per control 3.4.1 and 3.4.2, <company> IT staff reviews the different capabilities of the system and compares them to what is required by employees. If there is functionality enabled by default that is not needed, this is disabled. Least functionality is also ensured by having IT provision the system and ensure it meets baselines before delivery to a user."
  - Jake (Fellow)

- **HW/SW/FW inventory with justification:** List with column explaining business need for each software entry, correlated with AppLocker GPO settings.

- **AppLocker group policy settings:** Screenshots or exports showing software restrictions aligned with approved software list.

- **Configuration management tool exports:** Puppet, GPO, Intune, or similar showing least functionality configurations.

---

## Key Quotes

> "How do you do least functionality? How is your system configured to provide that? Then show it."
> - Jake (Fellow)

> "Say what you do, prove that you do it."
> - Jake (Fellow)

> "Capabilities are a broader concept than what 3.4.7 addresses. Capabilities are not limited to a particular system or platform but are a more general concept encompassing the full range of resources required to accomplish a mission or objective. This includes technology, people, process, and other resources. 3.4.7 complements 3.4.6 in that it requires restricting programs, functions, protocols, and services that do not support the capability defined in 3.4.6."
> - Alabaster

> "For my big companies, I use the example of an email server that would not be an internet gateway, domain controller, or firewall."
> - Alabaster

> "If my laptop came preinstalled with Kaspersky does that make it ok? No. Still yours to identify control and manage."
> - Uncouth (CCP, Fellow)

> "But if the tools have a purpose to you, like recovery, then your justification is easy. You do need to do it though."
> - Uncouth (CCP, Fellow)

> "I like seeing justification for installed SW somewhere. If the installed SW is different from the 3.4.1 baseline, you need the 3.4.3 and 3.4.4 documentation for that change."
> - Kenneth Ingham (CCA)

---

## Relationship to Other Controls

- **3.4.1 (Baseline configurations):** Least functionality settings are part of baseline configuration items.
- **3.4.2 (Security configuration settings):** Tied to baseline enforcement.
- **3.4.3/3.4.4 (Change control):** Any deviation from baseline (including keeping pre-installed software) requires change management documentation.
- **3.4.7 (Restrict programs, functions, protocols, services):** Complements 3.4.6 by restricting specific items that do not support defined capabilities. 3.4.6 is the broader "define capabilities" while 3.4.7 is the specific "restrict what does not support those capabilities."

---

*Source: Cooey COE Discord - configuration-management - 3.4.6 channel*
*Export date: 2026-01-07*
*Messages analyzed: 21*
