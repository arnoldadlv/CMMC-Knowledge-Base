# 3.13.7 - Expertise Overlay

**Control Text:** Prevent remote devices from simultaneously establishing non-remote connections with organizational systems and communicating via some other connection to resources in external networks (i.e., split tunneling).

---

## Sufficient

### For Traditional On-Premises VPN Environments
- VPN configuration with split tunneling disabled at the firewall/VPN concentrator level
- "We just disabled split tunneling for VPN through our external facing firewall/switch" - MonkSecurity (CCP)
- Full tunnel VPN to on-prem, then connections to cloud resources

### For Cloud-Only/M365 GCC-High Environments
- Endpoints configured with host-based controls acting as their own work boundary:
  - Host-based firewall (Windows Firewall denying unsolicited inbound traffic)
  - EDR (e.g., SentinelOne)
  - DNS filtering / Web content filtering (Umbrella, Zscaler, etc.)
  - Antivirus
  - SIEM monitoring
- "Pushing the same network security controls that exist on your conventional firewall to an endpoint was enough to satisfy the assessors questions" - itsallsimple (C3PAO)
- "During 4 different JSVAs it was accepted for clients I worked with that because the endpoints had EDR, SIEM, host based firewall, etc that monitored and controlled traffic at the endpoint's own boundary it was not an issue" - Cuipacabra (CCP)

### "Securely Provisioned Connections" Approach
- Multiple TLS-secured connections to trusted cloud services without VPN tunneling
- M365 GCC-High traffic using TLS 1.2+ is considered "securely provisioned"
- "Because you're controlling all outbound requests, and we know M365 GCC High traffic is expected and trustworthy: you can simply allow the connection without tunneling it through your corporate firewall" - rybo (Fellow, MEP)

### Zero-Trust/SASE Environments
- SSE/SASE platforms controlling DNS resolution for all layer 3-7 network connection attempts
- Agent/proxy on devices comparing outbound requests to company rules
- Host-based firewalls blocking unsolicited inbound connections (layer 2 protection)
- Exempt specific FQDNs from inspection to preserve confidentiality

### No On-Premises CUI Infrastructure
- Organizations with no on-prem CUI can meet the requirement by "prohibiting remote access to on-prem" - MonkSecurity (CCP)

---

## Insufficient

### Without Documented Controls
- Simply claiming cloud-only architecture eliminates the requirement (DoD CIO disagrees)
- Relying solely on Microsoft's Placemat statement without endpoint controls
- "I had the joy of a DIBCAC assessor classify connections to Azure/M365 as Split Tunnelling and as such we had to prove that the device itself was its own work boundary" - itsallsimple (C3PAO)

### Compensating Controls Without Technical Enforcement
- "What you are describing is a compensating control or custom approach, allowed in other standards but not here. Here, the requirement is the requirement." - Glenda R. Snodgrass (Lead CCA)
- Policy-only statements without technical implementation

### VDI Without Risk Acceptance
- "Mileage may vary, but I have yet to have DIBCAC on a C3PAO assessment allow the device connecting to the VDI to be out of scope and instead they make us explain how we are managing the risk of it (CRMA)" - itsallsimple (C3PAO)
- Note: rybo reported opposite experience - assessor variability exists

---

## Over-engineering

### Hosted VPN Concentrator for Cloud-Only Orgs
- "I've seen an MSSP take this one down a rabbit hole that I felt was overkill but certainly meets the spirit of the intent by deploying a hosted VPN concentrator in some cloud like AWS or Azure with a dedicated static public IP, using a VPN client on laptop with VPN Always On and split tunneling disabled, then using Azure Conditional Access Policy to limit M365 access from that VPN concentrator's static public IP. I mean I guess but that is counter to 'Cloud' being a thing in our industry" - OzzieGRC

### Requiring VPN for Direct M365 GCC-High TLS Connections
- DoD CIO's interpretation that users must be prevented from internet access while connected to GCC-High was criticized as "outrageous interpretation" and "wildly absurd"
- "Asking a rulemaking/policymaking office (DoD CIO) for implementation advice is like asking Bill Gates what it's like to be poor" - rybo

---

## Edge Cases

### Cloud-Only Organizations (No On-Prem Infrastructure)
- **Controversial:** DoD CIO stated that M365/Azure users are "non-remote" and must be prevented from simultaneous internet access
- **Community Response:** Criticized as impractical; most practitioners accept endpoint controls as meeting the intent
- Microsoft Placemat states cloud environments "eliminate split tunnel connections" but not universally accepted by DIBCAC

### Printing to Local/Home Printers
- "Am I right in thinking that with split tunneling disabled, remote RDP users can't print from terminal servers to their own local printers?" - Answer: Yes
- **Solutions:**
  - Prevent device redirection (including printers) using Remote Desktop Services settings
  - Block or restrict print services at the host firewall
  - Limit printing to USB-connected printers if possible
  - Document authorized data flows via 3.1.3 and configure essential services via 3.4.6/3.4.7

### VPN Split-Tunneling to GCC-High Only
- "Our VPN only allows split tunneling to GCCH, any other traffic routes through the VPN tunnel" - accepted approach
- "I'm planning to force all traffic through VPN *except* m365 gcc high, including teams" - be prepared to defend this implementation

### Laptop-to-GCC-High Connections
- "I consider remote as outside-to-on-prem. I don't consider laptop->gcc high remote" - MonkSecurity
- **Counter-view from CCA (Spock67):** "The definition of remote access is anything over the internet...So I would say that access to GCCH from instances 2 and 3 are both remote"

### Remote/Non-Remote Definition Confusion
- "800-171 also says using a VPN does not make the connection non-remote (aka using a VPN the connection is still considered remote)" - Cuipacabra
- "I honestly don't know how to make a connection from a remote device be 'non-remote'" - recognized terminology issue

### R3 ODP Difference
- **R2:** "communicating via some other connection to resources in external networks"
- **R3 ODP:** "communicating via some other **unauthorized** connection to resources in external networks"
- "So, we could likely say any connections allowed from the endpoint are authorized so long as EDR, host based firewall, web content/DNS filtering are enforced on the endpoint" - Cuipacabra

### SASE/ZTA TLS Inspection Consideration
- If SASE product performs TLS "break and inspect" and CUI is inspected, the platform becomes a "covered contractor information system" requiring FedRAMP Moderate equivalency
- "It's a major dealbreaker for many new SSE/SASE providers" - rybo

---

## Evidence Examples

### VPN Configuration Screenshots
- VPN concentrator/firewall settings showing split tunneling disabled
- "I expect assessors to make this simple, check configuration settings on VPN" - MonkSecurity (CCP)

### Endpoint Security Configuration
- Windows Firewall rules denying unsolicited inbound traffic
- EDR agent deployment evidence
- DNS filtering/web proxy configuration
- SIEM log collection configuration

### Policy Documentation
- Documented authorized data flows
- Remote access policy stating split tunneling configuration
- "OJ Defense" approach: Document how you would satisfy the requirement if it had somewhere to apply (for cloud-only orgs)

### Referenced Whitepaper
- DefCert whitepaper on CMMC and Split Tunnels: https://defcert.com/wp-content/uploads/2022/02/CMMC-and-Split-Tunnels_Feb2022.pdf
- "We coauthored a whitepaper with Microsoft and others regarding CMMC and split tunnels...we know of several orgs who have used it to defend 'multiple securely provisioned connections' instead of full tunnel (especially with M365 GCC High) during DIBCAC assessments" - rybo

---

## Key Quotes

### On Practical Implementation
> "Deny unsolicited inbound traffic on Windows Firewall and call it good. Try to limit printing to USB connected printers if at all possible. Subject all outbound traffic to a proxy (Umbrella, Zscaler, etc.) and you should be sitting pretty." - rybo (Fellow, MEP)

### On Assessor Variability
> "We were able to get them to agree that it wasn't split tunneling and the assessor was overstepping the definition." - itsallsimple (C3PAO)

> "There are many CCAs who are very strict at interpreting the controls and would not pass that." - Glenda R. Snodgrass (Lead CCA)

### On the "OJ Defense"
> "It's the best way to satisfy the requirement without needing a documented exemption. The requirement still 'applies' to your organization, it simply has nowhere to be applied. Document how you would satisfy the requirement if it had somewhere to apply." - rybo

### On Control Antiquity
> "I know the requirement says to literally 'prevent' split tunneling, but it is such an antiquated requirement that I'm wondering if alternate methods that meet the intent are being accepted by some C3PAOs" - Cuipacabra (CCP)

> "I chalk it up to NIST not fully considering a full SAAS environment. There are going to be problems like this." - MonkSecurity (CCP)

### On DoD CIO Guidance
> "The real lesson is to stop asking people who have never implemented anything to tell us how it's done." - rybo (Fellow, MEP)

> DoD CIO: "If your company's network is completely based on Azure Government/M365 GCC High...all of your users should be considered as 'non-remote' users assuming that they have full access to those Azure system resources. Accordingly, when connected to your controlled (Azure) network, they must be configured to prevent a simultaneous connection to an uncontrolled network."

> Community response: "Flat out wrong. You can connect to an uncontrolled external system and your org systems simultaneously all day long, so long as the connections use the same tunnel/path/route." - Cuipacabra (CCP)

### On R3 Changes
> "Did you know that NIST removed it from r3 but DoD put it back with their ODPs? So DoD still considers it the standard." - Glenda R. Snodgrass (Lead CCA)

### On Requirement Absurdity
> "It's a hilarious requirement because remote workers could just disconnect from the VPN whenever they don't need to access anything on-prem so there is no 'split tunneling' and can access GCCH without needing to be on the VPN and it satisfies this requirement yet adds no additional security to just allowing split tunneling from the VPN in the first place." - Cuipacabra (CCP)

---

## Sources
- Cooey COE Discord Channel: #3.13.7 (system-and-communications-protection)
- Discussion period: September 2022 - November 2025
- Key contributors: rybo (Fellow, MEP), itsallsimple (C3PAO), Cuipacabra (CCP), Glenda R. Snodgrass (Lead CCA), MonkSecurity (CCP), OzzieGRC, Spock67 (CCA, CCP)
