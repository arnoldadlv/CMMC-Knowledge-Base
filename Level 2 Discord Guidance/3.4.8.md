# 3.4.8 - Expertise Overlay

**Control Text:** Apply deny-by-exception (blacklisting) policy to prevent the use of unauthorized software or deny-all, permit-by-exception (whitelisting) policy to allow the execution of authorized software.

**Assessment Objectives:**
- 3.4.8[a] a policy specifying whether whitelisting or blacklisting is to be implemented is specified.
- 3.4.8[b] the software allowed to execute under whitelisting or denied use under blacklisting is specified.
- 3.4.8[c] whitelisting to allow the execution of authorized software or blacklisting to prevent the use of unauthorized software is implemented as specified.

---

## Sufficient

### Blacklisting (Deny-by-Exception) Approach
Per ace_rimmer (Fellow):
- Create a written deny list and use that as evidence
- Use inventory to confirm nothing in the deny list is installed
- Block software not needed for business purposes
- Examples of deny list items: EOL/EOS software, keyloggers, unapproved AV or VPN software, alternative PDF viewers when standardized, games

### Whitelisting/Allowlisting Approach
- Policy could reference CISA's CDM Approved Products List as a whitelist basis
- List of authorized software with admin privileges required for all installations

### Government-Specific Denials
Per ace_rimmer (Fellow):
- "The only Gov denied software is Kaspersky AFAIR"
- Beyond that, deny list is based on company requirements

### Implementation with Admin Controls
If users cannot install software without admin privileges, and you track installations via AV/inventory tool - this can support the control, but requires additional documentation of what happens when unauthorized software is discovered.

---

## Insufficient

### Inventory-Only Without Pre-Approved List
Per ace_rimmer (Fellow):
- "The only problem there is that your allowlist is the software that's installed. So if a rogue sysadmin installs Steam so they can play CoD, then it shows up in your inventory and is allowed"
- Simply having admin privileges required and tracking installed software is "Maybe" sufficient - need additional controls

### Blacklisting Without Documentation
Per Uncouth (Fellow/CCP), while blacklisting is technically allowed:
- "It's a sleazy way to answer blacklisting"
- Must still have documented list of denied software

---

## Over-engineering

No discussion found.

---

## Edge Cases

### Admin-Only Installation + Inventory
Question raised: "Can you fulfill this control by having a list of authorized software, require administrator privileges for all software installations, and have an always up-to-date list of currently installed software?"

Response (ace_rimmer): "Maybe" - but you need to:
1. Track additions to software that was not pre-approved
2. Document that you worked with users that installed unauthorized software
3. Have a mechanism beyond just "admin required"

### Handling Unauthorized Installations
If a user somehow installs something without admin privileges, the system administrator should know about it (via inventory/AV) - but the key is what happens next (investigation, remediation, documentation).

---

## Evidence Examples

- Written deny list document
- Software inventory from AV/endpoint tool confirming no denied software installed
- Policy stating blacklisting or whitelisting approach
- List of authorized software
- Documentation of unauthorized software incidents and remediation
- CISA CDM Approved Products List reference (if used as whitelist basis)

---

## Key Quotes

> "The only Gov denied software is Kaspersky AFAIR. Your denylist will be based on your company's requirements, so there isn't an easy answer"
> -- ace_rimmer (Fellow)

> "Yes your policy could say anything on that list is what is allowed" (regarding CISA CDM APL)
> -- ace_rimmer (Fellow)

> "The only problem there is that your allowlist is the software that's installed. So if a rogue sysadmin installs Steam so they can play CoD, then it shows up in your inventory and is allowed"
> -- ace_rimmer (Fellow)

> "I would create a written deny list and use that as evidence"
> -- ace_rimmer (Fellow)

> "You can use your inventory to confirm nothing in the deny list is installed"
> -- ace_rimmer (Fellow)

> "What do you a) not want running and b) don't need from a business sense?"
> -- ace_rimmer (Fellow)

> "Some examples are EOL/EOS software, keyloggers, unapproved AV or VPN software"
> -- ace_rimmer (Fellow)

> "You may decide you have one standard PDF viewer or CAD software and deny alternatives so you can share files internally easier"
> -- ace_rimmer (Fellow)

> "3.4.8[b] the software allowed to execute under whitelisting or denied use under blacklisting is specified. [b]: Spotify is denied use under blacklisting."
> -- Uncouth, CCP (Fellow) - demonstrating minimal blacklisting compliance

> "Its a sleazy way to answer blacklisting"
> -- Topher (CCP) - commenting on minimal blacklisting approach

---

*Source: Cooey COE Discord - configuration-management - 3.4.8 thread*
*Export date: 2026-01-07*
