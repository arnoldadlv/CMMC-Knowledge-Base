# 3.4.2 - Expertise Overlay

**Control Text:** Establish and enforce security configuration settings for information technology products employed in organizational systems.

**Assessment Objectives:**
- 3.4.2[a]: Security configuration settings for information technology products employed in the system are established and included in the baseline configuration.
- 3.4.2[b]: Security configuration settings for information technology products employed in the system are enforced.

---

## Sufficient

### Documentation Approaches That Pass
- **STIG checklist with documented deviations and rationale** - Completing a STIG checklist and documenting deviations with justification is acceptable
- **Intune + Autopilot with documented baselines** - Golden images are "old-school"; you can enforce baselines using Intune compliance policies, update rings, and settings catalog. **Key requirement:** You must write down the baseline parameters. "Just because something is a certain way in Intune doesn't mean it's supposed to be that way in Intune. You need a document to compare against." (rybo)
- **GPO enforcement with change management process** - Configurations enforced via GPOs with documented change management
- **Software baselines incorporated by reference** - Create separate baselines for software (e.g., SFT-ADOBE-ACR-RDR, SFT-MSFT-EDGE) and reference them in OS baselines. Changes to software baselines don't invalidate OS baselines.
- **Auto-update as a configuration setting** - For frequently-updating apps like Zoom, document "auto update turned on, and a policy that users are not to ignore or block updates" (Glenda Snodgrass, CCA)
- **Firewall rules with business justification in spreadsheet** - Exporting configs to Excel with explanation of each rule "would make almost every assessor very happy" (Amira Armond, C3PAO)
- **Ticket numbers in firewall rule comments** - Including ticket numbers allows retrieval of "request, context, and approval history" (Jeff Baldwin, CCA)
- **STIG with documented exceptions** - Define baseline as "STIG minus approved exceptions" and document the exceptions (Uncouth)

### What Assessors Accept
- "As an assessor, I don't care what tools you use. I want you to be able to show me info when I ask for it." (Glenda Snodgrass, CCA)
- Excel spreadsheets are acceptable for documenting baselines
- Screenshots plus text files of configurations are acceptable
- Endpoint monitoring tool output is acceptable for software inventory
- Risk-based exceptions where testing is too risky: "I would document it saying the risk is too great to test" (Liatris, CCA)

---

## Insufficient

### Common Gaps Identified
- **Config files without rationale** - "The biggest gap when your baseline is just a config file is that config files don't tell you why a particular setting was included in the configuration or whether it's security-relevant and subject to change approval." (rybo)
- **Backup of existing configuration without documentation of what should be** - "Simply backing up existing configurations isn't establishing what those should be." (Glenda Snodgrass, CCA)
- **Settings not mapped to requirements** - "If you want to pass an assessment with flying colors, then the settings need to be mapped somehow to the requirements they meet." (rybo)
- **Undocumented firewall rules** - Rules without comments explaining purpose will cause problems: "two years later you're going to be wondering why port 5832 is open and have no answers" (Amira Armond, C3PAO)

### Verification Requirements
- Without a compliance scanning tool, assessors expect "sampling of manual reviews, lots of looking at GPO settings in AD, and going to a few samples of different types and running RSOP to see that they applied" (Jeff Baldwin, CCA)

---

## Over-engineering

### Explicitly Called Out
- **Individual baselines for OS-bundled apps like Notepad, MS Paint** - "Don't over-think this stuff - you're going to drive yourself crazy! Is it even possible to change security settings on notepad? I would say that the general security settings in Windows will control any applications that are bundled with the OS." (Glenda Snodgrass, CCA)
- **Separate baselines for individual apps in a suite** - "You don't need to establish a baseline for individual apps that are included in a suite, just for the suite as a whole." (Glenda Snodgrass, CCA)
- **Requiring golden images when modern MDM works** - "Golden images are kind of old-school at this point." (rybo)

### Right-sizing Guidance
- **Simple software with minimal risk factors** - "Let's say you've got some locally installed software. It has no database backend, no network connectivity, and no data sharing capabilities (email, cloud integration, etc.). The only thing worth tracking in a baseline might be the required minimum version." (rybo)
- **Multi-role servers** - "If you have multiple servers with the same OS but different server roles, consider a core baseline for the OS settings and an appendix for any unique server roles' settings." (rybo)

---

## Edge Cases

### Security vs. Specialty Assets
- **SPAs (Specialized Assets) vs. CUI Assets** - "Your primary burden to have baselines exists for the assets that process, store, or transmit CUI (servers, etc.)... For the assets that aren't directly handling CUI (most switches, cameras, and door badge systems): it's wise to maintain a baseline for the settings that contribute to meeting 800-171 requirements (SPA settings) and any settings that prevent them from accidentally handling CUI (CRMA settings)." (rybo)
- **Out-of-scope determination** - "If physical or logical separation eliminates the possibility of CUI handling, then the asset is out of scope." (rybo)

### STIG Exceptions
- **NTLM STIG level reduction for business functionality** - One practitioner documented dropping NTLM STIG from Level 5 to Level 4 because "Level 5 breaks program transfer to my CNC machines"
- **Exceptions where testing is too risky** - For STIG items where the consequences of testing are unknown and potentially severe: "I would document it saying the risk is too great to test" (Liatris, CCA)
- **STIG exceptions are not enduring exceptions to CMMC** - STIG exceptions are documented deviations from your chosen baseline, not exceptions to CMMC requirements. "Just define it as 'STIG minus approved exceptions' or whatever and move on" (Uncouth)

### Software Installed After Imaging
- Software pushed after base image (e.g., via SCCM) is still part of the baseline. Use separate software baselines incorporated by reference into the OS baseline.

### Windows 11 App Management Challenges
- "Windows 11 does weird things with some apps that even if the sys admin deletes them, they mysteriously show back up in users accounts." - Practical advice: "choose an endpoint monitoring tool then going with whatever the tool produces" (MonkSecurity)

---

## Evidence Examples

### Accepted Evidence Types
1. **STIG checklist** with documented deviations and rationale
2. **GPO settings documentation** plus RSOP samples from representative systems
3. **Intune compliance policies and settings catalog exports**
4. **Firewall rule spreadsheet** with columns for: rule, ports/protocols, services, business justification, ticket number
5. **Configuration backup files** (text files) plus documentation explaining the "why"
6. **Screenshots of key configuration settings**
7. **SCAP/compliance scan reports** - "A SCAP scan isn't required, but it's a swiss-army audit proof. Any time a system setting is your best way to show how you satisfy a requirement, you can use the report results as proof." (rybo)
8. **Intune reporting** for compliance across all machines
9. **Software baselines** documenting: name, min/max version, licensing info, system settings

### Dual-Purpose Evidence
- Firewall configuration spreadsheet can serve as evidence for both 3.4.2 (security configuration) and 3.4.7 (ports, protocols, services). "Before you start, review the other CM requirement to allow only necessary programs ports protocols services... your spreadsheet should be able to act as evidence for both" (Amira Armond, C3PAO)

### Format Flexibility
- Baselines can be documented in: Word docs, Excel spreadsheets, comments in PowerShell scripts, XML output

---

## Key Quotes

> "Golden images are kind of old-school at this point. You can certainly enforce a baseline using various Intune functions (compliance policies, update rings, settings catalog, etc.). The trick is to actually write down the baseline parameters. Just because something is a certain way in Intune doesn't mean it's supposed to be that way in Intune. You need a document to compare against."
> -- rybo (Moderator, Fellow, MEP)

> "The biggest gap when your baseline is just a config file is that config files don't tell you why a particular setting was included in the configuration or whether it's security-relevant and subject to change approval. If you want to pass an assessment with flying colors, then the settings need to be mapped somehow to the requirements they meet."
> -- rybo (Moderator, Fellow, MEP)

> "As an assessor, I don't care what tools you use. I want you to be able to show me info when I ask for it."
> -- Glenda R. Snodgrass (Lead CCA)

> "Don't over-think this stuff - you're going to drive yourself crazy! Is it even possible to change security settings on notepad? I would say that the general security settings in Windows will control any applications that are bundled with the OS."
> -- Glenda R. Snodgrass (Lead CCA)

> "Best practice is to have a comment for each rule that says why the rule exists. If you don't, two years later you're going to be wondering why port 5832 is open and have no answers."
> -- Amira Armond (C3PAO)

> "There's not really a direct requirement for compliance scanning. There is a direct requirement for vulnerability scanning. Hopefully your assessor recognizes those two things are not the same thing."
> -- Jeff Baldwin (CCA, RPO)

> "A SCAP scan isn't required, but it's a swiss-army audit proof. Any time a system setting is your best way to show how you satisfy a requirement, you can use the report results as proof."
> -- rybo (Moderator, Fellow, MEP)

> "Using the STIG means you have less documentation to produce since the lion's share is already done for you."
> -- sardonis (CCP)

> "Assessors--whether DIBCAC or CMMC--shouldn't be giving style points. The focus isn't on how a control is implemented but whether it meets the requirement."
> -- Alabaster

> "The intent of this requirement is that you base your configurations on the reference baseline (STIG) and document any deviations."
> -- Liatris (LCCA, C3PAO)

---

*Source: Cooey COE Discord - configuration-management - 3.4.2 channel*
*Export date: 2026-01-07*
*Message count: 69*
