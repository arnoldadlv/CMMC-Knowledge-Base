# 3.4.7 - Expertise Overlay

**Control Text:** Restrict, disable, or prevent the use of nonessential programs, functions, ports, protocols, and services.

**Source:** Cooey COE Discord - configuration-management channel

---

## Sufficient

### Ports, Protocols, Services (PPSM) Approach
- **Combine ports, protocols, and services together** - rybo (Moderator/Fellow) recommends grouping these as PPSM (Ports, Protocols, Services Management) rather than treating each separately
- **Three-tier classification accepted:**
  - **Essential:** Ports/protocols/services needed to meet requirements (e.g., TLS 1.2)
  - **Restricted:** Allowed only as part of an approved and documented network traffic rule (deny-by-default architecture)
  - **Prohibited:** Known unsecured protocols blocked as standalone rules to prevent accidental allowance
- **Block well-known insecure ports at the firewall** which effectively blocks the associated protocol and service
- **Blocking all incoming ports on network firewall and user devices, plus blocking outgoing ports except approved ones** - this approach was asked about as acceptable for AOs g-o
- **Blacklist approach is currently acceptable:** Define everything as essential except what you explicitly block (Spock67, Certified Assessor) - "Until we get into Rev 3, blacklisting approach is allowed"

### Functions Definition
- **Functions = device/system capabilities** that can be technically restricted
- Acceptable examples from Amira Armond (C3PAO/Fellow):
  - Essential: Reading, editing, saving documents; sending/receiving project emails
  - Non-essential: Online gambling, games, music player
  - Restrictable functions: Bluetooth, printing

### Programs
- **Thoughtful review of each program** - if you can look at a program list and say "that is not needed for work," turn it off (Amira Armond)
- Games are explicitly called out as non-essential programs to block

### Documentation Location
- **Both approaches acceptable:** Lists can be in SSP OR in referenced external documentation, as long as it's available and provided to the assessor

---

## Insufficient

No discussion found of specific "insufficient" or failing evidence scenarios.

---

## Over-engineering

### Service-Level Granularity Concerns
- **Defining every Windows service is NOT required** - "Even a fresh Windows system has a significant amount of services running... there could easily be 100 items. No way are we defining if they are essential or not. We don't even have the knowledge on what 1/2 those services are." (User concern)
- **Assessor acknowledgment:** Spock67 (Certified CMMC Assessor) called this his "least favorite control" due to complexity and varying interpretations

### Separate Bins for Ports vs Protocols vs Services
- **Not necessary to parse into different bins** - Users expressed difficulty distinguishing between protocols and services as separate categories. Assessor guidance supports combining PPSM together.

---

## Edge Cases

### "Use" vs "Existence" Distinction
- **Simply having a port open may not constitute "use"** - thwackooey notes that defining "use of non-essential" separately allows you to say that having a port open is different from seeing actual traffic over that port
- Most organizations define "use of non-essential" as the inverse of "essential" (though this "feels pointless")

### Unknown Services Risk
- **Services you don't understand:** "What do you do when there are so many services which we are not 100% sure whether we should disable? Disabling certain services may break the system."
- **Solution:** Use blacklist approach - define everything as essential except what you explicitly prohibit

### Network-Level vs Device-Level Services
- **Device level:** Windows services.msc - about reducing attack surface by disabling unneeded services on the device
- **Network level:** Services accessible across the network or remotely - can be controlled via firewalls
- Both perspectives are valid; device-level is "more zoomed in" and becomes part of baseline configuration

---

## Evidence Examples

### Documented/Mentioned Evidence Types
1. **PPSM list/table** showing essential, restricted, and prohibited ports/protocols/services
2. **Firewall rules** blocking all incoming ports and most outgoing ports
3. **List of essential programs** required for work
4. **List of essential functions** (e.g., document editing, email)
5. **Policy defining prohibited services** (e.g., games, online gambling)
6. **Debloat script** for new devices - don't use vanilla Windows install
7. **GPOs/registry keys** for controlling services
8. **Screenshot shared:** List of prohibited ports/protocols including old/insecure ones (attachment referenced)

### Acceptable Documentation Locations
- Within the SSP directly
- Separate referenced documents (policies, procedures)
- Either approach acceptable as long as documentation is provided to assessor

---

## Key Quotes

> "I keep ports, protocols, and services together (PPSM). Essential ports, protocols, and services are, at a minimum, those needed to meet requirements (i.e., TLS 1.2). Restricted ports, protocols, and services are those we allow, but (in a deny-by-default network architecture) only as part of an approved and documented network traffic rule. Prohibited ports, protocols, and services are known, unsecured protocols we want to block as a standalone rule, just to make sure we don't accidentally allow them in an approved network traffic rule."
> -- rybo (Moderator/Fellow/MEP)

> "Should show a thoughtful review of each. If you can open a program list and say that is not needed for work, turn it off."
> -- Amira Armond (C3PAO/Fellow)

> "My documentation has examples such as... For example, the ability to read, edit, and save documents, or to send and receive emails related to a project is essential functionality. For example, online gambling is non-essential function. We list bluetooth, printing, music player as functions that can be technically restricted..."
> -- Amira Armond (C3PAO/Fellow)

> "I would answer define a black list rather than white list approach. Define everything as essential except what you block."
> -- Spock67 (Certified CMMC Assessor)

> "Until we get into Rev 3, blacklisting approach is allowed."
> -- Spock67 (Certified CMMC Assessor)

> "This is a great example of where the 171A approach to assessing this does not make a lot of sense in my view."
> -- Spock67 (Certified CMMC Assessor)

> "This is my least favorite control. Truly."
> -- Spock67 (Certified CMMC Assessor)

> "It's about reducing the attack surface and hardening it by disabling services that aren't needed. Services in this context could be yes, the services you run on the device. Less services, less things to attack."
> -- Jeff Baldwin (Certified CMMC Assessor/Fellow)

> "Right, so it make sense to make a debloat script you run on your new devices and don't use them with a vanilla install of Windows."
> -- Jeff Baldwin (Certified CMMC Assessor/Fellow)

---

## Notable Contributors
- **rybo** (Moderator/Fellow/MEP) - PPSM framework
- **Amira Armond** (C3PAO/Fellow) - Functions definition, programs approach
- **Spock67** (Certified CMMC Assessor) - Blacklist approach, documentation flexibility
- **Jeff Baldwin** (Certified CMMC Assessor/Fellow) - Services definition, debloat scripts, attack surface reduction

---

## Topics Not Discussed
- Specific pass/fail assessment scenarios with verdicts
- Explicit examples of rejected evidence
- Specific prohibited protocol lists (image attachment referenced but not included)
- Cloud service considerations
- Mobile device specifics
