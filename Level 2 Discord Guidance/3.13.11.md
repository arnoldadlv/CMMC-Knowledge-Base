# 3.13.11 - Expertise Overlay
## Employ FIPS-validated cryptography when used to protect the confidentiality of CUI

---

## Sufficient

### Physical Boundary Protection
- CUI protected by physical safeguards (locked facilities, badge access) does NOT require FIPS encryption under Rev2
- "If you have physical protections, confidentiality of CUI can be met with those physical protections, therefore no FIPS needed." (Spock67)
- DoD Procurement Toolbox confirms: "Encryption used for other purposes, such as within applications or devices within the protected environment of the covered contractor information system, would not need to be FIPS-validated."

### Applications Using OS Crypto Modules
- Applications that leverage Windows FIPS-validated modules (like WinZip Enterprise) are acceptable when Windows is in FIPS mode
- "If WinZip is using FIPS validated modules in the OS to do its encryption, it's good." (Glenda R. Snodgrass, Lead CCA)
- "Winzip Enterprise on a Windows PC in FIPS mode inherits Microsoft's FIPS validation because they use the Windows cryptography modules."

### GCC High / FedRAMP Connections
- "All connections to GCCH are fips validated by default, no matter the settings on the endpoint. Web session security is controlled by the server."
- FedRAMP Moderate baseline includes SC-13 (FIPS requirement), so FedRAMP services satisfy 3.13.11 for their covered functionality

### TLS with FIPS-Mode OS
- TLS 1.2/1.3 connections from Windows in FIPS mode using OS crypto modules are sufficient
- "TLS 1.2/3 uses the underlying operating system encryption module. So that means for windows that you must have the OS configured for FIPS mode. Then TLS 1.3 is fine."

### Historical FIPS Certificates
- Historical 140-2 certificates can still pass assessment when logged as Temporary Deficiency
- "Temporary deficiencies as MET, therefore, I'm pretty confident that a Historical FIPS Cert can be considered MET, if logged as a TD"
- Assessment guide example: "FIPS-validated cryptography that requires a patch and the patched version is no longer the validated version may be a temporary deficiency."

### Network Equipment Not Doing Encryption
- Switches that pass through encrypted traffic do NOT need FIPS validation
- "The switch is not doing the encryption so does not need to be FIPS validated." (Spock67, CCA)
- "Unless your switches are doing any actual encryption for you, they will not need FIPS."

---

## Insufficient

### FIPS-Compliant vs FIPS-Validated
- "Watch out for things that say FIPS compliant. Not good enough. Must be FIPS validated"
- "FIPS validated (not compliant. Compliant is no bueno)"
- Must be able to identify the specific CMVP certificate number

### Using FIPS Algorithms Without Validated Module
- "If a piece of software uses for example AES-256 encryption which is a FIPS validated encryption method but the software/module is not listed in their approved certified modules... would it still be uncompliant?" - YES, insufficient

### Adobe Acrobat for Primary CUI Encryption
- Adobe modules listed on NIST site are "Historical" not currently validated
- "Point is that using Adobe as your primary encryption for CUI is probably insufficient"
- Adobe can be used if Windows is in FIPS mode AND you configure Acrobat's FIPS registry setting, but this requires careful verification

### Non-FIPS VPN When Required
- "Encrypted but not FIPS is points lost (2pts) and is POAMable" (Jake is on the move)
- OpenVPN and similar may not use FIPS-validated modules - must verify the specific cryptographic module used

### Browser-Based Access Assumptions
- "Not all browsers rely on the underlying OS modules for TLS. Chromium and Edge are examples of browsers that leverage their own cryptographic libraries so just configuring an OS in FIPS mode isn't always the silver bullet."

---

## Over-engineering

### FIPS on Network Switches
- "Your switches don't need FIPS. Web interfaces don't need FIPS."
- Switches are pass-through devices; encryption happens at endpoints

### FIPS on Internal Printers
- "We don't encrypt to our printers because you can use non-FIPS inside your enclave, because we have physical safeguards and data controls in place"
- Printers within physical boundary are protected by physical controls

### Double-Encryption
- "You don't need to double encrypt"
- If CUI is already encrypted via FIPS TLS, the VPN tunnel doesn't also need FIPS
- "VPN: is the traffic already FIPS-validated before being sent down the tunnel? then the VPN tunnel is only re-encapsulating already-validated data, and FIPS might be unnecessary"

### SharePoint Internal Hashing
- "Computing hash values inside SharePoint would count as unnecessary FIPS'ing"
- Internal application hashing for indexing/tagging is NOT protecting CUI confidentiality

### FIPS Firewall When Not Needed
- "We did not do this early enough and have wasted money on a FIPS firewall that it turns out we don't need at all."
- Only need FIPS at encryption/decryption points, not pass-through devices

### Everything Everywhere FIPS
- "A common misperception in CMMC and 800-171 compliance is that FIPS validated cryptography is required for your WIFI, remote access, passwords, MFA devices, and everything else you can think of. This is an example of holding the bar too high."

---

## Edge Cases

### WiFi / Wireless Access Points
- "If you transmit CUI over wifi that also needs FIPS" - BUT most WiFi APs lack FIPS validation
- Workaround: Use FIPS-validated TLS before WiFi transmission, or require wired connections for CUI
- "The consensus of this discord has been that you only need FIPS when protecting CUI outside your scoped boundary. Also, most everyone doesn't try FIPS for wireless APs (almost no solutions out there). Instead FIPS connection to your in-scope boundary."
- Aruba Instant line: conflicting reports on FIPS validation status; verify current CMVP listing

### Ubuntu/Linux Endpoints
- Ubuntu Pro 22.04 has FIPS validated module, but enabling fips kernel causes driver issues
- "The device seems heavily limited after booting with the fips kernel. It won't connect to wifi networks that are not themselves fips-compliant, and hardware drivers don't like the outdated kernel"
- Workaround options: Windows host with Ubuntu VM, or Apricorn external drives

### Printing CUI
- "Printing is my nemesis for this reason. It's basically impossible to FIPS encrypt print jobs."
- Workaround: "Dedicated print machine connected to the printer directly. Any printing of CUI must happen locally from that machine."
- Universal Print with Connector on segregated VLAN is another approach

### Self-Hosted Applications Over Internet
- "cert alone won't cut it here, your best bet is to proxy the app behind something that is FIPS Validated"
- NGINX Plus has FIPS compliance option as reverse proxy
- Must identify the actual crypto modules used, not just the certificate

### Systems Outside Boundary Accessing CUI
- If laptops leave physical boundary, they need FIPS for at-rest and in-transit
- "Laptops have to be FIPS. The cryptologic module associated with the OS is what is used to form many TLS connections"

### Rev2 vs Rev3 Physical Safeguards
- "Alternative physical safeguards can be used to protect unencrypted CUI inside your physical boundary under r2, but that option was removed with r3"
- Plan for future: "I would not spend money on non-FIPS equipment at this time unless you will be happy to replace it again in 1-3 years"

### Windows FIPS Mode vs BitLocker Settings
- Windows must be in FIPS mode for BitLocker to be FIPS validated
- "I'm 95% sure the security policy specifies that Windows must be in FIPS mode to be FIPS validated"
- Intune sets MDMManaged registry key (not the standard FIPS key) - still valid for FIPS enablement

### Newer OS Versions Beyond Validated Version
- Running Windows version newer than FIPS-validated version is common and POAMable
- "Basically everyone running Windows these days is on a newer version and the Gov just wants it to be on your POAM"
- Log as Temporary Deficiency

---

## Evidence Examples

### Acceptable Evidence
- CMVP certificate number for each crypto module protecting CUI confidentiality
- Windows FIPS mode registry setting (or MDMManaged key = 1 for Intune)
- SCAP scan showing FIPS configuration
- BitLocker status with FIPS-compliant cipher suites
- Security policy document from CMVP for vendor modules

### Evidence Approach
- "We mapped every place where we think FIPS encryption is required in our entire CUI flow and are now writing in depth papers on each that make the case for FIPS compliance digging out how and where the encryption actually takes place"
- Asset Management + System Diagrams showing CUI flow and encryption points
- "Skip down to page 34 [of security policy] and make sure you could demonstrate compliance with the requirements they list for proper configuration"

### What to Reference in SSP
- "I would describe this in the SSP as using the MS Module" (when app uses Windows crypto)
- Reference specific CMVP certificate numbers
- Show FIPS mode is enforced via policy (GPO, Intune, etc.)

---

## Key Quotes

### On the Requirement's Scope
> "The 'when' in the requirement is the important part, the switch has no role in the use of crypto to protect CUI." (MysteryShack)

> "Employ FIPS-validated cryptography when used to protect the confidentiality of CUI." - Focus on the "when"

### On Physical vs Crypto Protection
> "Physical security can be used instead to protect the confidentiality of the CUI. Recall that Media includes Paper... for which there is no encrypting. Still have to be protected and physical is it." (Spock67)

> "Draw your physical boundary, cui in transit outside of that boundary needs encryption"

### On Validated vs Compliant
> "Remember, FIPS Compliant is a dirty word"

> "FIPS validated (not compliant. Compliant is no bueno)"

### On Understanding CUI Flow
> "You really really need to analyze your CUI data flow."

> "This of course then is helped perhaps by your strong (and mandated) Asset Management capability that has all assets categorized in accordance with the scoping guide."

### On the Difficulty
> "There are a lot of razor blades in there [speaking of 171]. FIPS is one of them in a system that is demanding 100% implementation with 100% evidence for everything... and then calling it 'just moderate level of security that everyone should just do.'" (Spock67)

> "I hate FIPS Validation requirement" (widely agreed)

> "Just a reminder that FIPS is stupid" (repeated sentiment in channel)

### On Historical Certificates
> "IF a cert has gone to Historical status, you are probably running a version of that application/OS beyond what is validated anyways, which means it's certainly a Temporary Deficiency regardless"

### CCA Perspective
> "I'm a CCA and I agree... If WinZip is using FIPS validated modules in the OS to do its encryption, it's good." (Glenda R. Snodgrass, Lead CCA)

---

## FIPS Level Discussion

- "There are four security levels described in FIPS 140-2. DFARS does not require any specific level of security with the FIPS requirement."
- "If there is no language then CUI basic requirement would be at least level 1."
- Specific FIPS levels (L2, L3) only required if contract language specifies

---

## Vendor-Specific Notes

### FortiGate
- FortiOS 7.0.x is FIPS validated (though older)
- "We are running v7.0.12 build9223 (FIPS-CC-70-16) on all our Fortigates"
- VPN functionality may be limited in FIPS mode; verify specific use case

### Netgear
- "I can tell you with 99% certainty that Netgear is not going to be FIPS validated, now or ever. None of the prosumer budget brands can justify the FIPS validation lab fees."

### Aruba
- Instant line has conflicting FIPS information
- Full Aruba APs start around $1000/AP for FIPS validated versions
- One user confirmed running IAP mode with FIPS successfully

### Veeam
- "Veeam Backup and Replication has a FIPS validated mode that uses the windows FIPS validates modules for encryption."

### WolfSSL
- "Many FedRAMP SaaS providers use something like Wolf SSL because it's FIPS validated"
