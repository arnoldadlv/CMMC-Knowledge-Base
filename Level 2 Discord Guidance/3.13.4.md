# 3.13.4 - Expertise Overlay
## Control Text
Prevent unauthorized and unintended information transfer via shared system resources.

---

## Sufficient

### Modern Windows OS as Primary Evidence
- **Screenshot showing modern Windows version** (Windows 10/11, Server 2019/2022) was accepted as evidence in at least one assessment: "we just showed a screenshot that we were in fact using a modern version of Windows" - itsallsimple (C3PAO/AOS-G)

### DIBCAC Interpretation (Technical Focus)
- DIBCAC assessors focus on **Kernel DMA Protection** rather than file share access controls
- "DIBCAC just checked if Kernel DMA protection was enabled and then moved along" - Cuipacabra (CCP, went through JSVA)
- Controlling access to user data within shared folders is considered addressed by Access Control (AC) domain, not this control per DIBCAC

### Assessor-Confirmed Sufficient Approach
From a certified CMMC Assessor (CUIbert, C3PAO/CCA):
- Modern version of Windows
- Users without admin access to their machines (can't peruse other users' folders)
- Written policy that all users have unique credentials
- Kernel DMA/Core Isolation/related settings pushed to endpoints as baseline (recommended to bolster case)

### NIAP Certification Documentation
- For firewalls handling unencrypted CUI: reference NIAP documentation with SC-4 compliance
- Map from SC-4 to protection profile (for firewalls: FDP_RIP.2)
- Reference vendor's submission, configuration guide, and third-party validation report

### Environment-Wide Access Control
- "Access control is typically generalized to environment-wide. Not only specific CUI systems, but all systems that have access to each other." - Amira Armond (C3PAO)

---

## Insufficient

### SSP Too Focused on Access Control Language
An ISM critique of SSP text that focused on general access control, user authorization, and file/folder permissions:
- "Your SSP text hits general access control, but 3.13.4 specifically cares about how your systems prevent residual data exposure between processes and users"
- Need evidence that systems are configured to enforce the protections Windows provides
- Need to show BitLocker enabled to address hibernation/page file protection
- Need configuration reports showing settings applied to endpoints

### Vendor Documentation Alone
- Vendor documentation (e.g., Microsoft security target) showing Windows meets requirement is "kinda" sufficient but still needs organizational evidence
- Must show "a GPO, asset list, baseline reports" to tie vendor doc to your specific assets and configs

### Firewall-Only Focus
- No DISA SRGs for networking gear (firewalls, routers, switches, IDPS) include rules with CCI references to SC-4
- "This is more OS-related" - consensus from discussion

---

## Over-engineering

### CPU-Level Object Reuse Concerns
- "Sure you can go super technical and worry about cpu cycles but the main use cases are: shared computers with users saving outside of their profile. Terminal servers again allowing users to save in public locations." - Amira Armond (C3PAO)
- "I wouldn't expect cpu and object reuse to be tested unless the OSC is trying to reinvent the hypervisor / multi user operating system from scratch" - Amira Armond

### Deep Technical Memory Management
- Explaining "object reuse" or "residual information protection" requires explaining "roughly how a CPU / Memory works within a modern OS" - considered unnecessary for typical assessments

### CCA vs DIBCAC Scope Differences
- CCAs reportedly ask about file shares, user profile folders, Teams/SharePoint - broader than DIBCAC approach
- DIBCAC approach (Kernel DMA focused) appears more streamlined
- "Access to file shares and such seems like it is addressed sufficiently within the AC domain/family" - Cuipacabra

---

## Edge Cases

### Shared Kiosk Systems
- In access-controlled physical environment where all employees are authorized and screened for CUI access, a shared kiosk with shared CUI storage could be permissible for this specific control
- However, other controls would still apply (MFA for CUI access, individual identification/accountability, etc.)
- "Identifying actions of individuals would be a problem but not having a data location that all can access" - Amira Armond

### Network Printers
- "Would a network printer used by various people in an office be a shared system resource?" - question raised
- "Not a typical scenario that assessors think about" - Amira Armond
- Enterprise printers have ability to disable history and storing of printed documents - mentioned as relevant capability

### Encrypted Data on Shared Resources
- NIST 800-171r2 Discussion section states: "This requirement also applies to encrypted representations of information"
- Assessors found this confusing if encryption is a confidentiality protection mechanism
- Possible interpretation: cloud providers hosting multiple clients can use different encryption keys per client as shared resource protection
- "The CMMC further discussion is not peer reviewed" - Amira Armond's diplomatic response to confusing guidance

### VoIP and Cryptographic Isolation
- If VoIP is "physically or cryptographically isolated from an information system processing CUI, this control would not apply (but it would be prudent to apply the requirement)" - from NIST FAQ

### CRMA vs CUI Asset Implementation
- CRMAs can use primarily administrative controls: "Users are told not to store sensitive information on the asset, therefore no unintended or unauthorized information transfer is likely"
- CUI Assets need technical implementation: STIG, DMA protection, etc.
- "The means of how you implement a control on a given class of asset can be different" - Uncouth (CCP)

---

## Evidence Examples

### Accepted Evidence (Reported)
1. Screenshot of Windows version showing modern OS
2. Kernel DMA Protection status (via System Information or msinfo32)
3. NIAP certification documentation for firewalls with SC-4 mapping
4. GPO configurations for baseline security
5. Asset list with OS versions
6. Baseline configuration reports

### Evidence Types Mentioned
- Device Security (Core Isolation) screenshots
- Windows Security Target documents (st_vid10753-st.pdf for Win10+, 2022-21-ST_lite.pdf for Win11/Server 2022)
- Intune or GPO settings for DMA protection
- BitLocker status for hibernation/page file protection
- User access rights demonstrating no admin access to others' folders

### What Assessors Look For
- **DIBCAC**: Kernel DMA Protection enabled
- **CCAs**: File shares, user profile folders, Teams/SharePoint configurations (reportedly more expansive)

---

## Key Quotes

### Understanding the Control
> "This control addressed things like impersonation or poor resource cleanup. If a system is using memory protections but does not clean up or release the prior users' resources, it is an avenue for data loss or escalation. Encryption would not protect. For example, turning off remote assistance as it lets a remote user impersonate local user. Also turning off Anonymous shares or named pipes." - Alabaster

### Practical Interpretation Analogy
> "Dad, Mom, and little Susie all share the same family PC. Dad saves some porn to the root of the drive (accessible by all). Not a problem for Dad or Mom - they are both authorized for porn. Problem for little Susie because she is unauthorized and not intended to get it. If the porn was saved to a location where only Mom and Dad could access using their permissions, we would also be good." - Amira Armond (C3PAO)

### Simplified Assessment View
> "If everyone with access has authorization to see the same stuff, doesn't matter" - Amira Armond

### DIBCAC vs CCA Divergence
> "When I went through JSVA DIBCAC seemed to disagree with this interpretation. Controlling access to user data within a shared folder or root folder is addressed within AC they stated. I was told this control is for things like Kernel DMA Protection, etc." - Cuipacabra

> "That has been my experience as well. The DIBCAC assessments I've participated in they have more or less glossed over this because 'it's built into windows', even for situations where we used shared hosts for RDP. CCA's however, always ask about file shares, user profile folder, and Teams/SharePoint." - itsallsimple (C3PAO)

### Modern Windows Default
> "All that being said, with Windows 11 (and you all are running Windows 11, *right?*) all of the VBS stuff is enabled out of the box and should be enabled on all devices in your environment unless you have a very good reason to disable it." - John

### Assessor's Pass Criteria
> "As an assessor, I'm of the mind that a modern version of Windows, a user base that doesn't have admin access to their machines so they can't peruse other users folders, and a written policy that all users have unique credentials, gets you across the finish line here. Additionally, I think it's a great idea to make sure you have Kernel DMA/Core Isolation/related settings pushed to your endpoints as baseline to bolster your case." - CUIbert (C3PAO/CCA)

---

## Assessor Disagreement Notes
There is documented tension between:
- **DIBCAC approach**: Focus on Kernel DMA Protection, treat file share access as AC domain issue
- **CCA approach**: More expansive review including file shares, user profiles, SharePoint/Teams

The discussion section from 800-171 appears to justify the DIBCAC (technical memory/process isolation) interpretation.

---

## Control Relationship Notes
- File/folder access permissions overlap with Access Control (AC) domain
- Encryption for shared resources relates to 3.13.8 (cryptographic protection) and 3.13.11 (encryption at rest)
- Individual identification overlaps with AU family requirements
- Hypervisor isolation relates to virtualization security discussions
