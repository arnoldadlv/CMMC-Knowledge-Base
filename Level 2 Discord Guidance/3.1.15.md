# 3.1.15 - Expertise Overlay
## Control Text
Authorize remote execution of privileged commands and remote access to security-relevant information.

## Assessment Objectives
- 3.1.15[a] privileged commands authorized for remote execution are identified.
- 3.1.15[b] security-relevant information authorized to be accessed remotely is identified.
- 3.1.15[c] the execution of the identified privileged commands via remote access is authorized.
- 3.1.15[d] access to the identified security-relevant information via remote access is authorized.

---

## Sufficient

### What "Remote Execution" Actually Means
- This control is about **nonlocal command execution** - commands triggered on a system when the user is NOT locally logged into that machine
- Focus areas: PowerShell remote execution, bash scripts, SSH commands, MDM-pushed scripts, centralized configuration management tools, API calls that execute commands on remote hosts
- **Intune pushing PowerShell scripts to endpoints** is a good example of remote command execution that falls under this control

### VPN Clarification
- Once connected via VPN, privileged commands executed while logged into the local OS are NOT considered "remote execution of privileged commands" for this control
- DIBCAC-approved SSP language: "Once a user connects to an approved remote access session, it no longer is a remote execution of privileged commands"
- VPN connection makes it a "local connection" for purposes of this control - you must be on the network to run privileged commands

### Cloud-Only Environments
- For GCC/GCC-High environments: Can use Conditional Access policies to control access; VPN not required if CA policies properly restrict access
- Azure/Entra privileged roles can be identified in an appendix, with policy stating those roles and their commands are permitted for remote execution
- Defining commands by role is acceptable: "All privileged commands granted with [role] are authorized to be performed remotely"
- For cloud-only, treat role-based permissions as the definition of allowed remote commands

### Managed Device Considerations
- If administrators manage Azure/Intune from Intune-enrolled, managed company laptops, these are NOT remote commands - they are in-scope systems
- "Remote means from an IS that is not your in-scope one"
- Key question: Are commands coming from organizational managed devices? If yes, in-scope and compliant

---

## Insufficient

### Misunderstanding "Remote"
- Confusing VPN remote access (3.1.12) with remote command execution (3.1.15)
- Saying "we don't have remote access" when users VPN in - VPN IS remote access per NIST definition
- NIST definition of remote access: "access to an organizational system by a user (or a process acting on behalf of a user) communicating through an external network (e.g., the Internet)"

### Not Identifying What Can Be Pushed Remotely
- Failing to identify all remote execution vectors: PowerShell policies, MDM pushes, patch management, RMM tools, SSH access
- Not documenting who can perform remote privileged actions

### Assessor Challenged: Vague Role References
- One assessor challenged the statement that "admin can perform all commands they are permitted to remotely" and wanted a specific list of commands
- Resolution: Show Entra ID roles assigned and state commands are scoped to what those specific roles permit

---

## Over-engineering

### Trying to Enumerate Every Command
- Creating exhaustive lists of individual commands instead of using role-based authorization
- Better approach: Reference administrative roles (e.g., Entra ID roles) that define permitted commands

### Separate Treatment from Related Controls
- Trying to solve 3.1.15 in isolation - it should be addressed alongside 3.1.12, 3.1.13, and 3.1.14 (AC-17 control family in 800-53)
- These controls "stack" and should be solved together

---

## Edge Cases

### SD-WAN and Site-to-Site VPN
- P2P VPN between offices = extension of network, NOT remote access
- Always-on encrypted tunnel between offices with router = extension of network
- Laptop that "sometimes VPNs in" = remote access
- Key distinction: permanent site-to-site tunnel vs. on-demand user VPN connection

### Zscaler/Cloud-Based Perimeter
- Zscaler Internet Access paired with host-based firewall = fully functional VPN replacement
- Qualifies as managed access control point under TIC 3.0 guidance
- Without firewall: Still functions as managed access control point but vulnerable to layer 2 traffic not subject to DNS resolution

### Quick Assist/Remote Support Tools (Teams Screenshare, TightVNC)
- Using VNC over VPN to remote into a domain controller = compliant (VPN makes it local)
- TeamViewer or GoToMyPC without VPN = true remote access, requires authorization
- Key: Is it going through your remote access solution (VPN) first?

### SharePoint Admin Center Access
- Accessing SharePoint Online admin center via browser from home = "remotely accessing system management/privileged functions"
- NOT the same as "executing commands from a remote host"
- Distinction: remote access to management interface vs. pushing scripts/commands remotely

### AVD/Cloud-Only Administration
- If "there is no way to administer not remotely" (100% cloud), you can treat connections from managed endpoints as "local" with proper Conditional Access
- Must still identify what privileged commands can be executed and who can execute them

---

## Evidence Examples

### DIBCAC-Approved SSP Language
"Per controls 3.1.12 and 3.1.14, remote access into the [company] network is strictly controlled. There are no privileged commands authorized for remote execution, as you must be on the network to run these privileged commands. [Company] also does not allow any security-relevant information to be accessed remotely. Once a user connects to an approved [company] remote access session, it no longer is a remote execution of privileged commands."

### Policy Statement for Cloud Environment
"All Azure privileged roles identified in Appendix 1 and the commands that those roles can execute are permitted to be remotely executed. The remote execution of all privileged commands is monitored and logged."

### Role-Based Authorization Approach
- Document admin group/roles in RBAC
- State "Everyone in Admin Group can perform privileged commands"
- Reference Entra ID roles assigned and what they permit

### Practical Documentation Breakdown
- a. Identify what can be remotely pushed (software, PowerShell commands, patches, etc.)
- b. Identify security-related data involved (audit logs, configs, etc.)
- c. Document who is allowed to run these things
- d. Document who can access security data from (b)

---

## Key Quotes

### On NIST Definition of Remote Access
> "According to NIST, remote access is: access to an organizational system by a user (or a process acting on behalf of a user) communicating through an external network (e.g., the Internet). Since your VPN traverses the internet, it is a remote connection." - rybo

### On VPN Not Eliminating Remote Access Status
> "The use of encrypted VPNs does not make the access non-remote; however, the use of VPNs, when adequately provisioned with appropriate control (e.g., employing encryption techniques for confidentiality protection), may provide sufficient assurance to the organization that it can effectively treat such connections as internal networks." - NIST 800-171r2 (via Jake)

### On What 3.1.15 Actually Covers
> "This requirement does not apply to someone using a VPN to log into a server at their corporate office. This requirement applies to someone using API calls, centralized configuration management tools, and other platforms to execute nonlocal commands on other boxes than the box they are logged into." - rybo

### On Control Stacking
> "This is the pain of discussing any of the remote access requirements without the others in context. 3.1.12, 3.1.13, 3.1.14, and 3.1.15 are AC-17, AC-17(1), AC-17(2), AC-17(3), and AC-17(4) in 800-53, and you don't try to solve them separately. They stack." - rybo

### On Assessor Inconsistency
> "DIBCAC is wildly inconsistent in their interpretations, and that your results will absolutely depend on your C3PAO and their interpretations. That's why, if you're going to float the idea that remote access isn't real and doesn't exist, you should gain pre-agreement with your C3PAO on that topic upfront, as a prerequisite for selecting them as your C3PAO." - rybo

### On Security-Relevant Information
> "It's vague and undefined because you end up defining it for your organization." - Liatris (C3PAO/CCA)

### On Remote Execution of Privileged Commands
> "Something from the internet (or the local network) reaches out and says, 'hey kid, run this.' Who's trusted (Intune, an admin PAW, a cert-signed script) and who's 'stranger danger' (IP address on the internet, another workstation on the domain)?" - rybo

### On Role-Based Authorization
> "There's nothing stopping you from saying 'All privileged commands granted with [role] are authorized to be performed remotely'. Often that is used in a cloud-only environment since everything would be remote, but it would still work for on-prem." - Liatris (C3PAO/CCA)

### On Practical Approach
> "Define the privileged commands allowed to be executed remotely as all commands able to be executed with the assigned admin permissions and roles." - Liatris (C3PAO/CCA)

---

## Common Misunderstandings Corrected

1. **VPN = Not Remote**: VPN access IS remote access per NIST, but once connected, you can "treat such connections as internal networks" and commands executed while logged into systems are not "remote execution of privileged commands"

2. **This Control vs 3.1.12**: 3.1.15 is about what commands/info you authorize for remote execution, not about defining remote access (that's 3.1.12)

3. **Remote Commands vs Remote Login**: Using Quick Assist/Teams to take control of a user's screen and run commands there is different from pushing scripts via Intune - the former is remote access to a session, the latter is remote command execution

4. **External Systems Confusion**: Company-owned, managed devices connecting over VPN are NOT external systems - this was "fought very hard to establish"

---

## Relationship to Other Controls

- **3.1.12**: Defines remote access methods and monitoring
- **3.1.13**: Implements cryptographic mechanisms for remote access
- **3.1.14**: Routes remote access through managed access control points
- **3.1.15**: Authorizes what privileged commands/security info can be accessed remotely
- **3.1.2**: Local authorization mirrors (nonlocal authorization for remote is the 3.1.15 version)
- **3.4.5**: Logical access controls to restrict remote command sources
